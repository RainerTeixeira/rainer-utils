{"version":3,"sources":["../../src/search/index.ts"],"names":["strValue"],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * Search Utilities\r\n *\r\n * Utilitários genéricos para busca e filtro de conteúdo.\r\n * Funções puras, agnósticas de domínio e framework.\r\n *\r\n * @module @rainersoft/utils/search\r\n * @author Rainer Teixeira\r\n * @version 1.0.0\r\n */\r\n\r\n/**\r\n * Opções de busca\r\n */\r\nexport interface SearchOptions {\r\n  /** Campos a buscar (padrão: ['title', 'description', 'content', 'tags']) */\r\n  fields?: string[];\r\n  /** Case sensitive (padrão: false) */\r\n  caseSensitive?: boolean;\r\n  /** Busca exata (padrão: false) */\r\n  exactMatch?: boolean;\r\n}\r\n\r\n/**\r\n * Busca genérica em array de objetos\r\n *\r\n * Função de busca client-side para arrays de objetos genéricos.\r\n * Busca em múltiplos campos configuráveis.\r\n *\r\n * @param query - Termo de busca\r\n * @param content - Array de objetos a buscar\r\n * @param options - Opções de busca\r\n * @returns Array filtrado com resultados\r\n *\r\n * @example\r\n * ```ts\r\n * const posts = [\r\n *   { title: 'Next.js Guide', description: 'Learn Next.js' },\r\n *   { title: 'React Basics', description: 'React fundamentals' }\r\n * ];\r\n * \r\n * searchContent('next', posts) // [{ title: 'Next.js Guide', ... }]\r\n * searchContent('react', posts, { fields: ['title'] }) // [{ title: 'React Basics', ... }]\r\n * ```\r\n */\r\nexport function searchContent<T extends Record<string, any>>(\r\n  query: string,\r\n  content: T[],\r\n  options: SearchOptions = {}\r\n): T[] {\r\n  if (!query.trim()) return content;\r\n  \r\n  const {\r\n    fields = ['title', 'description', 'content', 'tags'],\r\n    caseSensitive = false,\r\n    exactMatch = false\r\n  } = options;\r\n  \r\n  const searchQuery = caseSensitive ? query : query.toLowerCase();\r\n  \r\n  return content.filter(item => {\r\n    return fields.some(field => {\r\n      const value = item[field];\r\n      \r\n      if (!value) return false;\r\n      \r\n      // Se for array (ex: tags)\r\n      if (Array.isArray(value)) {\r\n        return value.some(v => {\r\n          const strValue = caseSensitive ? String(v) : String(v).toLowerCase();\r\n          return exactMatch \r\n            ? strValue === searchQuery \r\n            : strValue.includes(searchQuery);\r\n        });\r\n      }\r\n      \r\n      // Se for string\r\n      const strValue = caseSensitive ? String(value) : String(value).toLowerCase();\r\n      return exactMatch \r\n        ? strValue === searchQuery \r\n        : strValue.includes(searchQuery);\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Busca com score de relevância\r\n *\r\n * Retorna resultados ordenados por relevância baseado em:\r\n * - Correspondência no título (peso maior)\r\n * - Correspondência na descrição\r\n * - Correspondência em outros campos\r\n *\r\n * @param query - Termo de busca\r\n * @param content - Array de objetos a buscar\r\n * @param options - Opções de busca\r\n * @returns Array ordenado por relevância\r\n *\r\n * @example\r\n * ```ts\r\n * const results = searchWithScore('next', posts);\r\n * // Resultados com título contendo 'next' aparecem primeiro\r\n * ```\r\n */\r\nexport function searchWithScore<T extends Record<string, any>>(\r\n  query: string,\r\n  content: T[],\r\n  options: SearchOptions = {}\r\n): T[] {\r\n  if (!query.trim()) return content;\r\n  \r\n  const {\r\n    fields = ['title', 'description', 'content', 'tags'],\r\n    caseSensitive = false\r\n  } = options;\r\n  \r\n  const searchQuery = caseSensitive ? query : query.toLowerCase();\r\n  \r\n  // Calcula score para cada item\r\n  const scored = content.map(item => {\r\n    let score = 0;\r\n    \r\n    fields.forEach((field, index) => {\r\n      const value = item[field];\r\n      if (!value) return;\r\n      \r\n      const weight = fields.length - index; // Primeiro campo tem maior peso\r\n      \r\n      if (Array.isArray(value)) {\r\n        const matches = value.filter(v => {\r\n          const strValue = caseSensitive ? String(v) : String(v).toLowerCase();\r\n          return strValue.includes(searchQuery);\r\n        }).length;\r\n        score += matches * weight;\r\n      } else {\r\n        const strValue = caseSensitive ? String(value) : String(value).toLowerCase();\r\n        if (strValue.includes(searchQuery)) {\r\n          score += weight;\r\n          // Bonus se for match exato\r\n          if (strValue === searchQuery) {\r\n            score += weight * 2;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    \r\n    return { item, score };\r\n  });\r\n  \r\n  // Filtra apenas com score > 0 e ordena\r\n  return scored\r\n    .filter(({ score }) => score > 0)\r\n    .sort((a, b) => b.score - a.score)\r\n    .map(({ item }) => item);\r\n}\r\n\r\n/**\r\n * Busca fuzzy (tolerante a erros de digitação)\r\n *\r\n * Usa distância de Levenshtein simplificada para encontrar\r\n * correspondências aproximadas.\r\n *\r\n * @param query - Termo de busca\r\n * @param content - Array de objetos a buscar\r\n * @param options - Opções de busca + threshold\r\n * @returns Array com correspondências aproximadas\r\n *\r\n * @example\r\n * ```ts\r\n * fuzzySearch('nxt', posts) // Encontra 'next'\r\n * fuzzySearch('raect', posts) // Encontra 'react'\r\n * ```\r\n */\r\nexport function fuzzySearch<T extends Record<string, any>>(\r\n  query: string,\r\n  content: T[],\r\n  options: SearchOptions & { threshold?: number } = {}\r\n): T[] {\r\n  if (!query.trim()) return content;\r\n  \r\n  const {\r\n    fields = ['title', 'description'],\r\n    caseSensitive = false,\r\n    threshold = 0.6 // Similaridade mínima (0-1)\r\n  } = options;\r\n  \r\n  const searchQuery = caseSensitive ? query : query.toLowerCase();\r\n  \r\n  return content.filter(item => {\r\n    return fields.some(field => {\r\n      const value = item[field];\r\n      if (!value) return false;\r\n      \r\n      const strValue = caseSensitive ? String(value) : String(value).toLowerCase();\r\n      const similarity = calculateSimilarity(searchQuery, strValue);\r\n      \r\n      return similarity >= threshold;\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Calcula similaridade entre duas strings (0-1)\r\n * Usa algoritmo de Jaro-Winkler simplificado\r\n */\r\nfunction calculateSimilarity(str1: string, str2: string): number {\r\n  if (str1 === str2) return 1;\r\n  if (str1.length === 0 || str2.length === 0) return 0;\r\n  \r\n  // Busca substring\r\n  if (str2.includes(str1)) return 0.8;\r\n  \r\n  // Calcula caracteres em comum\r\n  const common = str1.split('').filter(char => str2.includes(char)).length;\r\n  const similarity = common / Math.max(str1.length, str2.length);\r\n  \r\n  return similarity;\r\n}\r\n"]}